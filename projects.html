<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<title>CNM Project Catalog</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:sans-serif;background:#f4f6f8}
header{background:#0a3d62;color:#fff;padding:12px}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;padding:12px}
.card{background:#fff;border-radius:8px;box-shadow:0 2px 6px rgba(0,0,0,.15);cursor:pointer;overflow:hidden}
.card img{width:100%;height:120px;object-fit:cover}
.card .info{padding:10px}
.card .code{font-size:12px;color:#666}
.card .name{font-weight:bold}
</style>
</head>

<body>

<header>
  <h3>Project Catalog</h3>
</header>

<div class="grid" id="projectGrid"></div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwVUUjXmRwJnJEmSr-D9MXbuBsPo3pdgnXPcKDFT0A2EStV5HthNb_5vOjDOVGkqGcL/exec";

init();

async function init() {
  const projects = await fetch(`${API_URL}?action=projects`)
    .then(r => r.json());

  const grid = document.getElementById("projectGrid");

  projects.forEach(p => {
    const card = document.createElement("div");
    card.className = "card";
    card.onclick = () => {
      window.location.href =
        `project.html?project_id=${p.PROJECT_ID}`;
    };

    card.innerHTML = `
      <img src="${p.COVER_IMAGE || 'https://via.placeholder.com/300x200'}">
      <div class="info">
        <div class="code">${p.PROJECT_CODE}</div>
        <div class="name">${p.PROJECT_NAME}</div>
      </div>
    `;
    grid.appendChild(card);
  });
}
</script>

</body>
</html>
